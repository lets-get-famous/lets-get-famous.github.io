<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Let's Get Famous</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="server.js"></script>
</head>
<body>
  <h2>Join a Room</h2>
  <input id="name" placeholder="Your Name" />
  <input id="code" placeholder="Room Code" maxlength="4" />
  <button onclick="joinRoom()">Join</button>
  <script>
    const socket = io();
  
    // Identify as web player
    socket.emit('identify', { clientType: 'web-player' });
  
    const form = document.getElementById('joinForm');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const playerName = document.getElementById('playerName').value.trim();
      const roomCode = document.getElementById('roomCode').value.trim();
  
      if (!playerName || !roomCode) return alert('Please enter name and room code');
  
      // Save playerName in localStorage
      localStorage.setItem('playerName', playerName);
  
      // Emit joinRoom event to server
      socket.emit('joinRoom', { roomCode, playerName });
  
      // Listen for successful join
      socket.on('loadGamePage', (data) => {
        localStorage.setItem('roomData', JSON.stringify(data.roomData));
        localStorage.setItem('characterStats', JSON.stringify(data.characterStats));
        window.location.href = '/game.html';
      });
  
      // Listen for join failure
      socket.on('joinFailed', (msg) => alert(msg));
    });
  </script>
</body>
</html>
